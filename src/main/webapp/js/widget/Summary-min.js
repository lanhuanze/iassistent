this.ajst["views/widget/summary/index.htm"]=function(obj){obj||(obj={});var __t,__p="";with(_.escape,Array.prototype.join,obj)__p+='<div class="widget-summary">\r\n    <img class="widget-summary-phone" src="'+(null==(__t=phoneImg)?"":__t)+'" onerror="javascript:this.src=\''+(null==(__t=Airdroid.DeviceManage.getDefaultPhoneImage())?"":__t)+'\';this.onerror = null;"/>\r\n    <div class="widget-summary-phoneName">\r\n        '+(null==(__t=UsedLang.DefaultText_Android)?"":__t)+'\r\n    </div>\r\n    <div class="over-ellipsis widget-summary-phoneOS">\r\n        '+(null==(__t=UsedLang.DefaultText_AndroidOS)?"":__t)+'\r\n    </div>\r\n    <div class="widget-summary-phoneLoad loading-white-mask is-hide">\r\n        <span>loading...</span>\r\n    </div>\r\n    <div class="widget-summary-phoneSize">\r\n        <div class="widget-summary-phoneMem">\r\n            <div class="widget-summary-sysIcon"></div>\r\n            <div class="widget-summary-sysUsed">\r\n                &nbsp;</div>\r\n            <div class="widget-summary-sysAvail">\r\n                &nbsp;</div>\r\n            <div class="widget-summary-sysInfo" title="'+(null==(__t=UsedLang.Title_InternalStorage)?"":__t)+'">'+(null==(__t=Common.Loading)?"":__t)+'</div>\r\n        </div>\r\n        <div class="widget-summary-phoneSD">\r\n            <div class="widget-summary-memIcon"></div>\r\n            <div class="widget-summary-sdUsed">&nbsp;\r\n            </div>\r\n            <div class="widget-summary-sdAvail">&nbsp;\r\n            </div>\r\n            <div class="widget-summary-sdInfo" title="'+(null==(__t=UsedLang.Title_SDStorage)?"":__t)+'">'+(null==(__t=Common.Loading)?"":__t)+'</div>\r\n        </div>\r\n\r\n        <div class="widget-summary-phoneExSD">\r\n            <div class="widget-summary-memIcon"></div>\r\n            <div class="widget-summary-sdUsed">&nbsp;\r\n            </div>\r\n            <div class="widget-summary-sdAvail">&nbsp;\r\n            </div>\r\n            <div class="widget-summary-sdInfo" title="'+(null==(__t=UsedLang.Title_exSDStorage)?"":__t)+'">'+(null==(__t=Common.Loading)?"":__t)+'</div>\r\n        </div>\r\n    </div>\r\n    <div class="widget-summary-opCon">\r\n        ',isQrNoAccount||(__p+='\r\n        <div class="widget-summary-switch" title="',__p+=isAddDevice?null==(__t=Common.add_devices)?"":__t:null==(__t=Common.switch_device)?"":__t,__p+='">\r\n            <span class="over-ellipsis">\r\n                ',__p+=isAddDevice?"\r\n                "+(null==(__t=Common.add_devices)?"":__t)+"\r\n                ":"\r\n                "+(null==(__t=Common.switch_device)?"":__t)+"\r\n                ",__p+="\r\n            </span>\r\n        </div>\r\n        "),__p+='\r\n        <div class="over-ellipsis widget-summary-detail" title="'+(null==(__t=UsedLang.Button_SummaryDetail)?"":__t)+'">\r\n            <span class="over-ellipsis">\r\n                '+(null==(__t=UsedLang.Button_SummaryDetail)?"":__t)+'\r\n            </span>\r\n        </div>\r\n    </div>\r\n    <div class="widget-summary-refresh icon icon_refresh ai-icon ai-icon-refresh">\r\n    </div>\r\n</div>';return __p};Airdroid.Widget.Summary=Core.extend(Airdroid.AppBase,{_refDOM:null,_lang:null,_phoneImg:"",_hasExSD:!0,initialize:function(){this._lang=this.util.getLang("Summary"),this._common=this.util.getLang("Common")},onCreate:function(){var e=this;e._phoneImg=e.util.checkUserLogin()?Airdroid.DeviceManage.getCurrentDeviceSmallImg():e._service.getPhoneImg(2,{}),this._refDOM=$(this.util.getTemplate("widget/summary","index",{phoneImg:e._phoneImg,UsedLang:e._lang,Common:e._common,isQrNoAccount:Airdroid.Runtime.QRNoAccount||Airdroid.Config.isLiteVersion,isAddDevice:!Airdroid.Util.checkUserLogin()||Airdroid.Util.checkUserLogin()&&2>Airdroid.UserManage.getDevices().length})),this.setContent(this._refDOM),this.startRunning(),this.util.keepWidgetInScreen(this._refDOM.parents(".widget"))},onResize:function(){},onClose:function(){},fillSummaryData:function(e){var t=Airdroid.DeviceManage.getCurrentDeviceName()||e.model;this._refDOM.find(".widget-summary-phoneName").text(t),this._refDOM.find(".widget-summary-phoneOS").html(e.osversion),0==e.support_sdcard?(this._refDOM.find(".widget-summary-phoneSD").hide(),this._refDOM.find(".widget-summary-phoneMem").css("top","70px"),this._refDOM.find(".widget-summary-phoneExSD").css("top","95px"),this.config.supportSDCard=!1):(this._refDOM.find(".widget-summary-phoneSD").show(),this.config.supportSDCard=!0),-1==e.size.ext_sd_size?(this._refDOM.find(".widget-summary-phoneExSD").hide(),this._refDOM.find(".widget-summary-phoneMem").css("top","70px"),this._refDOM.find(".widget-summary-phoneSD").css("top","95px"),this._hasExSD=!1):(this._hasExSD=!0,this._refDOM.find(".widget-summary-phoneExSD").show()),this._refDOM.find(".widget-summary-sysUsed").css("width",Math.round(202*((e.size.sys_size-e.size.sys_avail)/e.size.sys_size))+"px"),this._refDOM.find(".widget-summary-sysAvail").css("width",Math.round(202*(e.size.sys_avail/e.size.sys_size))+"px"),this._refDOM.find(".widget-summary-sysInfo").html(this.util.bytesToSize(e.size.sys_size-e.size.sys_avail)+" / "+this.util.bytesToSize(e.size.sys_size)),this._refDOM.find(".widget-summary-phoneSD .widget-summary-sdUsed").css("width",(202*((e.size.sd_size-e.size.sd_avail)/e.size.sd_size)).toFixed(0)+"px"),this._refDOM.find(".widget-summary-phoneSD .widget-summary-sdAvail").css("width",(202*(e.size.sd_avail/e.size.sd_size)).toFixed(0)+"px"),this._refDOM.find(".widget-summary-phoneSD .widget-summary-sdInfo").html(this.util.bytesToSize(e.size.sd_size-e.size.sd_avail)+" / "+this.util.bytesToSize(e.size.sd_size)),this._refDOM.find(".widget-summary-phoneExSD .widget-summary-sdUsed").css("width",(202*((e.size.ext_sd_size-e.size.ext_sd_avail)/e.size.ext_sd_size)).toFixed(0)+"px"),this._refDOM.find(".widget-summary-phoneExSD .widget-summary-sdAvail").css("width",(202*(e.size.ext_sd_avail/e.size.ext_sd_size)).toFixed(0)+"px"),this._refDOM.find(".widget-summary-phoneExSD .widget-summary-sdInfo").html(this.util.bytesToSize(e.size.ext_sd_size-e.size.ext_sd_avail)+" / "+this.util.bytesToSize(e.size.ext_sd_size))},refreshSummary:function(){var e=this,t=e._refDOM.find(".widget-summary-phoneSize"),i=function(){e._refDOM.find(".widget-summary-sysInfo,.widget-summary-sdInfo").html("..."),e._refDOM.find(".widget-summary-phoneLoad").addClass("is-hide")};e._refDOM.find(".widget-summary-phoneLoad").removeClass("is-hide"),t.hide(),this._service.getAndroidSummary(function(n){e.util.isReturnDataError(n)?i():(t.show(),e._refDOM.find(".widget-summary-phoneLoad").addClass("is-hide"),e.fillSummaryData(n),Airdroid.DeviceManage.setCurrentDeviceStatusObj(n),Airdroid.TaskbarManage.updateDeviceStatus(),Airdroid.Config.extendSdCardPath=n.ex_sd,e._dataCenter.contact.total=e.util.getGaCount(n.counts.contacts),Airdroid.Util.checkUserLogin()&&""==Airdroid.Util.getCookie("aridroid-"+Airdroid.DeviceManage.getCurrentDeviceDid())&&(Airdroid.Util.setCookie("airdroid-"+Airdroid.DeviceManage.getCurrentDeviceDid(),"1",604800),Airdroid.Util.trackEvent("W-Summary","Contacts-Count",e.util.getGaCount(n.counts.contacts)),Airdroid.Util.trackEvent("W-Summary","SMS-Count",e.util.getGaCount(n.counts.sms)),Airdroid.Util.trackEvent("W-Summary","APP-Count",e.util.getGaCount(n.counts.app)),Airdroid.Util.trackEvent("W-Summary","Music-Count",e.util.getGaCount(n.counts.music)),Airdroid.Util.trackEvent("W-Summary","Video-Count",e.util.getGaCount(n.counts.video)),Airdroid.Util.trackEvent("W-Summary","Photo-Count",e.util.getGaCount(n.counts.photo))))},function(){i()})},startRunning:function(){var e=this;this._refDOM.find(".widget-summary-detail").click(function(){return e.runApp(e.config.dependApps.summaryDetail,{hasExsd:e._hasExSD}),Airdroid.Util.trackEvent("W-Summary","Detail"),!1}),this.refreshSummary(),this._refDOM.find(".widget-summary-refresh").click(function(){e.refreshSummary();var t=new Image;if(/\?/.test(e._phoneImg))var i=e._phoneImg+"&dd="+Date.parse(""+new Date);else var i=e._phoneImg+"?dd="+Date.parse(""+new Date);$(t).load(function(){var i=$(t).addClass("widget-summary-phone").attr("new","1");e._refDOM.find(".widget-summary-phone").remove(),e._refDOM.append(i)}).error(function(){}).attr("src",i),Airdroid.Util.trackEvent("W-Summary","Refresh")}),Airdroid.MessageManage.addListener(Airdroid.MessageManage.EventTypes.device_change,function(t){console.log("summary ");var i=e._refDOM.find(".widget-summary-switch span"),n=t.data.device.length;switch(n){case 0:i.parent().hide();break;case 1:i.text(e._common.add_devices).parent().show();break;default:i.text(e._common.switch_device).parent().show()}}),Airdroid.MessageManage.addListener(Airdroid.MessageManage.EventTypes.current_device_setting_change,function(t){e._refDOM.find(".widget-summary-phoneName").text(Airdroid.DeviceManage.getDeviceName(t.data))}),this._refDOM.find(".widget-summary-switch").click(function(){Airdroid.DeviceManage.selectTargetDevice({isSwitch:!0}),Airdroid.Util.trackEvent("W-Summary","AddDevice")})}});