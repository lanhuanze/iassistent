Airdroid.Uploader=function(e){var t=this;return this._defaultFpath="/sdcard/",this._uploadFilePath="/sdcard/",this._avail=null,this._allowSupport=!0,this.UPLOADTYPE={XHR:"xhr",FLASH:"flash"},this.UPLOADSERVERTYPE={PHONE:"1",SERVER:"2"},this._uploadType=this.UPLOADTYPE.XHR,this._uploadServer=this.UPLOADSERVERTYPE.PHONE,t._commonLang=Airdroid.Util.getLang("Common"),t._uploadLang=Airdroid.Util.getLang("Upload"),t.init(e)},Airdroid.Uploader.prototype={isXHR:function(){var e=this;return e._uploadType===e.UPLOADTYPE.XHR},setFilePath:function(e){var t=this;t.isXHR()&&(t.opts.params.d=e),this._uploadFilePath=e,this.refreshDirUploadStates()},checkSendGetBeforeUpload:function(){var e=this;if(Airdroid.Util.isHttps()&&!Airdroid.DeviceManage.isCurrentDeviceRemote()&&e.checkUploadToPhone()&&Airdroid.Util.browser.chrome){var t=window.navigator.userAgent.indexOf("Chrome/");if(34>parseInt(window.navigator.userAgent.substr(t+7,2)))return!0}return!1},refreshDirUploadStates:_.throttle(function(e){var t=this;Airdroid.DeviceManage.getDirUploadStates(t._uploadFilePath,function(i){console.log(" "+i),t._avail=i.avail,t._allowSupport="1"==i.support?!0:!1,_.isFunction(e)&&e(i)})},2e3),checkAvaiData:function(e){var t=this;return t.checkUploadToPhone()&&t._avail?t._avail>e.size?(t._avail=t._avail-e.size,!0):(Airdroid.Util.alert(t._uploadLang.Msg_not_avail),!1):!0},checkUploadToPhone:function(){var e=this;return e._uploadServer===e.UPLOADSERVERTYPE.PHONE},checkMonthDataFlowWhileRemote:function(e){var t=this;if(Airdroid.DeviceManage.isCurrentDeviceRemote()&&t.checkUploadToPhone()){if(Airdroid.UserManage.checkMonthDataFlowOverage())return console.info("month data over flow!!!"),!0;if(e.size>1024*1024*Airdroid.Config.uploadMaxPerFileSize){if(Airdroid.Util.checkPremium()&&e.size>1024*1024*Airdroid.Config.uploadMaxPerFileSizePremium)return Airdroid.Util.alert(t._uploadLang.RemoteMode_FileTooLarge.format(Airdroid.Config.uploadMaxPerFileSizePremium)),!0;if(!Airdroid.Util.checkPremium())return Airdroid.Util.confirm(t._commonLang.RemoteMode_FileTooLarge_F.format(Airdroid.Config.uploadMaxPerFileSize,Airdroid.Config.uploadMaxPerFileSizePremium),function(){Airdroid.Util.showPremiumTip(Airdroid.Util._goPremiumType.remote_free_upload_more_10)}),!0}else if(Airdroid.Util.checkDataOverage(e.size))return Airdroid.Util.checkPremium()?(Airdroid.Util.alert(t._uploadLang.DataFlowNotAbleToUpload,function(){t.isXHR()&&t.upload()}),!0):(Airdroid.Util.confirm(t._commonLang.DataFlowNotAbleToUpload_P,function(){Airdroid.Util.showPremiumTip(Airdroid.Util._goPremiumType.remote_free_upload_overage),t.isXHR()&&t.upload()}),!0)}return!1},checkSupportUpload:function(){var e=this;return e._allowSupport?!0:(Airdroid.Util.alert(e._commonLang.upload_Permission_Denied),!1)},checkAllowUpload:function(e){var t=this;return!t.checkMonthDataFlowWhileRemote(e)&&t.checkAvaiData(e)&&t.checkSupportUpload()},setGA:function(e){var t=this,i=e.name.substr(e.name.lastIndexOf(".")+1).toLowerCase(),n=t.getGaFileSize(e.size);Airdroid.Util.trackEvent("M-Upload","Extension",i),1048576>e.size?Airdroid.Util.trackEvent("M-Upload","Size","Lt1m"):Airdroid.Util.trackEvent("M-Upload","Size",n),e.size>524288e3&&(Airdroid.Util.trackEvent("M-Upload","BigFile",n+"_"+i),console.log("big====>"+n+"_"+i)),Airdroid.Config.getUploadInfo&&(parseInt(Airdroid.Config.getUploadInfoMin)>0&&parseInt(Airdroid.Config.getUploadInfoMin)>e.size||parseInt(Airdroid.Config.getUploadInfoMax)>0&&parseInt(Airdroid.Config.getUploadInfoMax)<e.size||Airdroid.Service.getUploadSignleInfo({file_ext:i,file_name:e.name,file_size:e.size},function(e){1==e.code&&console.log("")}))},getGaFileSize:function(e){var t=Airdroid.Util.bytesToSize(e),i=t.split(" ")[1].slice(0,1),n=parseInt(t.split(" ")[0]),o=(""+n).length,r=Math.pow(10,o-1);return n=Math.floor(n/r)*r,n+i},getErrorMsgByCode:function(e){var t=this;e=!_.isUndefined(e)&&parseInt(e);var i=t._commonLang.upload_network_error;switch(e){case 0:i=t._commonLang.fail_to_upload;break;case-1:i=t._commonLang.apk_decode_error;break;case-2:i=t._uploadLang.Msg_not_avail;break;case-3:i=t._commonLang.upload_Permission_Denied}return i},init:function(e){var t=null;if(console.info(""),this._uploadServer=e.uploadServer||this.UPLOADSERVERTYPE.PHONE,Airdroid.Util.isSupportXHR()){var i={url:Airdroid.Service.getFileUploadPath(),params:{fn:e.common.fname||"",d:e.common.fpath||"",after:e.common.afterAction||"0",rtype:e.common.rtype||"0"},maxfiles:3,maxfilesize:-1,uploadStarted:function(i,n){console.log("start upload=="+n.name+",url="+this.url),t.checkUploadToPhone()&&(this.url=Airdroid.Service.getFileUploadPath()),n.id=i,$.isFunction(e.common.uploadStarted)&&(e.common.uploadStarted(n,t._uploadType),t.setGA(n))},progressUpdated:function(i,n,o){n.id=i,$.isFunction(e.common.progressUpdated)&&e.common.progressUpdated(n,o,t._uploadType)},uploadFinished:function(i,n,o){n.id=i;var r=_.isObject(o)?o:$.parseJSON(o);1==r.result?$.isFunction(e.common.uploadFinished)&&e.common.uploadFinished(n,r.data,t._uploadType):t.uploadError(r.result,n)},error:function(i,n){n=n||{},n.id=n.index||"",i=i||t._commonLang.fail_to_upload,$.isFunction(e.common.error)&&e.common.error(n,i,t._uploadType),t.refreshDirUploadStates()},cancel:function(t){$.isFunction(e.common.cancel)&&e.common.cancel(t)}},n=$.extend(!0,{},i,e.xhr);n.supportFolderUpload&&(Airdroid.Util.browser.chrome||(n.folderUploadBtnParentElement=null)),t=new Airdroid.XhrUploader,t.init(n)}else{if(this._uploadFilePath=e.common.fpath,this._uploadType=this.UPLOADTYPE.FLASH,!e.flash)return{};$.isFunction(e.flash.beforeInit)&&(e.flash.beforeInit(),delete e.flash.beforeInit);var i={flash_url:Airdroid.Config.baseUri+"assets/swf/swfupload.swf",flash9_url:Airdroid.Config.baseUri+"assets/swf/swfupload_fp9.swf",upload_url:Airdroid.Service.getFlashUploadPath(),use_query_string:!0,file_types:"*.*",file_types_description:Airdroid.Util.getLang("Upload","Label_FileTypesDesc"),button_placeholder_id:"",button_image_url:Airdroid.Service.getImgAssets("feature/select_files.png"),button_width:e.flash.buttonWidth,button_height:e.flash.buttonHeight,button_action:SWFUpload.BUTTON_ACTION.SELECT_FILES,button_cursor:SWFUpload.CURSOR.HAND,button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,file_dialog_start_handler:function(){t.checkUploadToPhone()&&this.setUploadURL(Airdroid.Service.getFlashUploadPath()),console.log("dialog_start")},file_dialog_complete_handler:function(){console.log("dialog_start upload"),this.startUpload()},file_queued_handler:function(i){$.isFunction(e.common.uploadStarted)&&(e.common.uploadStarted(i,t._uploadType),t.setGA(i)),console.log("file_queued_handler")},upload_start_handler:function(i){if(t.checkAllowUpload(i)){var n={loader:"2",fname:i.name,fpath:this._uploadFilePath,after:e.common.afterAction||"0",rtype:e.common.rtype||"0"},o=$.extend(!0,n,e.flash.param);this.setPostParams(o)}else this.cancelUpload(i.id,!0)},upload_progress_handler:function(i,n,o){var r=Math.round(100*(n/o));$.isFunction(e.common.progressUpdated)&&e.common.progressUpdated(i,r,t._uploadType)},upload_error_handler:function(i,n,o){console.log("flash upload error==>"+o),$.isFunction(e.common.error)&&e.common.error(i,t._commonLang.fail_to_upload,t._uploadType),t.refreshDirUploadStates()},upload_success_handler:function(i,n){var o=$.parseJSON(n);1==o.result?$.isFunction(e.common.uploadFinished)&&e.common.uploadFinished(i,o.data,t._uploadType):$.isFunction(e.common.error)&&e.common.error(i,t.getErrorMsgByCode(o.result),t._uploadType)}},o=$.extend(!0,{},i,e.flash);t=new SWFUpload(o)}this._uploadFilePath=e.common.fpath||this._defaultFpath;var r=this;for(var a in r)t[a]=$.isFunction(r[a])&&"init"!=a?r[a]:r[a];return t.refreshDirUploadStates(),t}},Airdroid.XhrUploader=Core.extend({maxListItemsOneTime:30,listItemTimeInterval:1500,listUploadItemsTimer:null,isCancel:!1,$construct:function(){console.info("XhrUploader========"),this.opts={},this.default_opts={fileUploadBtnParentElement:null,folderUploadBtnParentElement:null,dropArea:null,url:"",params:{},maxfiles:10,maxfilesize:1,isMultiple:!0,data:{},isFitDir:!0,drop:function(){},dragEnter:function(){},dragOver:function(){},dragLeave:function(){},beforeEach:function(){},afterAll:function(){},rename:function(){},error:function(e){alert(e)},cancel:function(){},uploadStarted:function(){},uploadFinished:function(){},progressUpdated:function(){},beforeLoad:function(){},afterLoad:function(){}},this.errors=["BrowserNotSupported.","TooManyFiles.","FileTooLarge.","Error."],this.files=[],this.fileSelectBtn=null,this.folderSelectBtn=null,this.uploadxhrs=[]},init:function(e){var t=this;t.uploadxhrs=[],t.files=[],t.fileSelectBtn=null,t.folderSelectBtn=null,jQuery.event.props.push("dataTransfer"),console.info(e),t.opts=$.extend(t.default_opts,e);var i=Airdroid.Util.getLang("Upload","Button_SelectFiles");t.opts.selectFilesBtnTitle&&(i=t.opts.selectFilesBtnTitle),null!=t.opts.fileUploadBtnParentElement&&(t.fileSelectBtn=Airdroid.Util.OS.Windows&&Airdroid.Util.browser.safari||!t.opts.isMultiple?$('<form><input type="file"  name="file" style=" width:100%;height:100%;"/></form>'):$('<form><input multiple="multiple" type="file"  name="file" style=" width:100%;height:100%;"/></form>'),t.opts.fileUploadBtnParentElement.append(t.fileSelectBtn),t.opts.fileUploadBtnParentElement.css({position:"relative",cursor:"pointer"}),t.fileSelectBtn.css({position:"absolute",right:"0px",top:"0px",width:"100%",height:"100%",margin:"0pt",padding:"0pt",cursor:"pointer",opacity:0}),t.fileSelectBtn.find("input").change(function(e){var i=e.target.files,n=i.length,o=function(){t.onFileInputChange(i,function(){$(e.currentTarget).parents("form")[0].reset()})};n>250?Airdroid.Util.confirm(Airdroid.Util.getLang("Filemanage","Message_FileItemMore"),o,function(){$(e.currentTarget).parents("form")[0].reset()}):o()}).attr("title",i)),null!=t.opts.folderUploadBtnParentElement&&(t.folderSelectBtn=$('<form><input multiple="multiple" type="file" name="file[]" webkitdirectory="" directory="" mozdirectory style=" width:100%;height:100%;"/></form>'),t.opts.folderUploadBtnParentElement.append(t.folderSelectBtn),t.opts.folderUploadBtnParentElement.css({position:"relative",cursor:"pointer"}),t.folderSelectBtn.css({position:"absolute",right:"0px",top:"0px",width:"100%",height:"100%",margin:"0pt",padding:"0pt",cursor:"pointer",opacity:0}),t.folderSelectBtn.find("input").change(function(e){var i=e.target.files,n=i.length;if(!(1>n)){var o=function(){$(e.currentTarget).parent("form")[0].reset()},r=function(){if(t.opts.isFitDir&&""!=i[0].webkitRelativePath){t.beforeLoad();var n={objname:i[0].webkitRelativePath.split("/")[0],d:t.opts.params.d,isfile:0};Airdroid.Service.checkNameExit(n,function(n){t.afterLoad(),n.oldname==n.newname?t.onFileInputChange(i,o):Airdroid.Util.confirm(Airdroid.Util.getLang("Upload","NameExistSureRename").format(n.oldname,n.newname),function(){t.beforeLoad();var r=[];_.each(i,function(e){r.push(e)});var a=function(){for(var e=[],i=0;t.maxListItemsOneTime>i;i++)r.length>0&&e.push(r.shift());return e};if(t.startUploadFolderQueque(a(),n.oldname,n.newname,e),r.length>0)var s=setInterval(function(){var i=a();i.length>0?t.startUploadFolderQueque(i,n.oldname,n.newname,e):(o(),clearInterval(s))},t.listItemTimeInterval);else o();t.afterLoad()},function(){o()})},function(){t.afterLoad(),t.onFileInputChange(i,o)})}else t.onFileInputChange(i,o)};n>250?Airdroid.Util.confirm(Airdroid.Util.getLang("Filemanage","Message_FileItemMore"),r,function(){o()}):r()}}).attr("title",Airdroid.Util.getLang("Upload","Button_SelectFolder"))),_.bindAll(t,"progress","rename","upload","onFileInputChange"),_.bindAll(t,"drop","dragEnter","dragOver","dragLeave","drop"),t.setDropArea(t.opts.dropArea)},onFileInputChange:function(e,t){var i=this;i.beforeLoad();var n=[];_.each(e,function(e){n.push(e)});var o=function(){for(var e=[],t=0;i.maxListItemsOneTime>t&&n.length>0;t++)e.push(n.shift());return e};return i.startUploadQueque(o()),n.length>0?i.listUploadItemsTimer=setInterval(function(){var e=o();e.length>0?i.startUploadQueque(e):(t(),clearInterval(i.listUploadItemsTimer))},i.listItemTimeInterval):t(),i.afterLoad(),!1},startUploadQueque:function(e){var t=this;return _.each(e,function(e){if(t.beforeEach(e)!==!1){var i=t.getUniqueId("uploadfileitem");e.index=i,"."!=e.name&&(e.fullpath=t.opts.params.d+"/"+t.getFilePath(e),t.opts.uploadStarted(i,e),t.files.push(e))}}),null===t.files||void 0===t.files?!1:(t.upload(),void 0)},startUploadFolderQueque:function(e,t,i,n){var o=this;return _.each(e,function(e){if(o.beforeEach(e)===!1)return $(n.currentTarget).parents("form")[0].reset(),!1;var r=o.getUniqueId("uploadfileitem");e.index=r,e._webkitRelativePath=e.webkitRelativePath.replace(t+"/",i+"/"),"."!=e.name&&(e.fullpath=o.opts.params.d+"/"+e._webkitRelativePath,o.opts.uploadStarted(r,e),o.files.push(e))}),null===o.files||void 0===o.files?!1:(o.upload(),void 0)},drop:function(e){this.opts.drop(e);var t=this;if(e.dataTransfer){if(e.dataTransfer.items&&_.isFunction(e.dataTransfer.items[0].webkitGetAsEntry)){console.log("support folder");for(var i=e.dataTransfer.items,n=0;i.length>n;n++){var o=i[n].webkitGetAsEntry();o&&t.traverseFileTree(o,"",e.currentTarget)}}else{if(console.log("not support folder"),_.each(e.dataTransfer.files,function(i){t.beforeLoad(),t.isFolder(i,function(n){if(n)t.opts.error(Airdroid.Util.getLang("Upload","notsupportdragfolders"));else if(i.dropArea=e.currentTarget,0!=t.beforeEach(i)){var o=t.getUniqueId("uploadfileitem");i.index=o,i.fullpath=t.opts.params.d+"/"+t.getFilePath(i),t.opts.uploadStarted(o,i),t.files.push(i)}})}),null===t.files||void 0===t.files)return t.opts.error(t.errors[0]),!1;t.afterLoad(),t.upload()}return e.preventDefault(),!1}},isFolder:function(e,t){var i;if(t=t||$.noop,e.type)t(!1);else if(Airdroid.Util.OS.MacOS&&Airdroid.Util.browser.safari||0==e.size%4096&&102400>=e.size)try{i=new FileReader,i.onerror=function(){t(!0)},i.onload=function(){t(!1)},i.readAsDataURL(e)}catch(n){t(!0)}else t(!1)},traverseFileTree:function(e,t,i){var n=this;if(t=t||"",e.isFile)e.file(function(e){if(console.log("File:",t+e.name),e.dropArea=i,0!=n.beforeEach(e)){var o=n.getUniqueId("uploadfileitem");if(e.index=o,""!=Airdroid.Util.getFileExt(e.name)){if(e.fullpath=n.opts.params.d+"/"+t+n.getFilePath(e),e.parentPath=t,n.opts.uploadStarted(o,e),n.files.push(e),null===n.files||void 0===n.files)return n.opts.error(n.errors[0]),!1;n.files&&1==n.files.length&&(n.afterLoad(),n.upload())}}});else if(e.isDirectory){var o={objname:t+e.name,d:n.opts.params.d,isfile:0};Airdroid.Service.checkNameExit(o,function(o){if(n.afterLoad(),o.oldname==o.newname){var r=e.createReader();r.readEntries(function(o){for(var r=0;o.length>r;r++)n.traverseFileTree(o[r],t+e.name+"/",i)})}else(function(e){Airdroid.Util.addBlockSingle(function(){Airdroid.Util.confirm(Airdroid.Util.getLang("Upload","NameExistSureRename").format(o.oldname,o.newname),function(){var r=e.createReader();r.readEntries(function(e){for(var r=0;e.length>r;r++){var a=o.newname;n.traverseFileTree(e[r],t+a+"/",i)}})})})})(e)})}},cancelUpload:function(e,t){var i=this,n=function(){_.each(i.uploadxhrs,function(t){t.upload.file.index==e&&(t.abort(),i.clearResendTimeId(t),i.uploadxhrs=_.without(i.uploadxhrs,t),i.opts.cancel&&i.opts.cancel(t.upload.file))})};if(0==t){var o=!1;_.each(i.files,function(t){t.index==e&&(o=!0,i.files=_.without(i.files,t),i.opts.cancel&&i.opts.cancel(t))}),o||n()}else n();i.upload()},cancelAll:function(e,t){var i=this;$.isFunction(e)&&e(),_.each(i.uploadxhrs,function(e){e.abort(),i.clearResendTimeId(e),i.uploadxhrs=_.without(i.uploadxhrs,e)}),i.files=[],t||(i.isCancel=!0),clearInterval(i.listUploadItemsTimer)},progress:function(e){var t=this,i=e.target;if(e.lengthComputable&&t.opts){var n=Math.round(100*e.loaded/e.total);if(i.currentProgress!=n){i.currentProgress=n;var o="0Kb/s";t.opts.progressUpdated(i.file.index,i.file,i.currentProgress,o)}}},clearResendTimeId:function(e){e.reSendTimeId&&clearTimeout(e.reSendTimeId)},uploadFile:function(e){var t=this,i=new XMLHttpRequest,n=(new Date).getTime();i.reSendTimeId=null,i.upload.file=e,i.upload.currentStart=n,i.upload.currentProgress=0,i.upload.startData=0,i.onload=function(e){console.info(e.currentTarget+"=====》"),t.clearResendTimeId(i);var o=e.currentTarget;if(o.responseText)if('{"err": "forbidden"}'==o.responseText)Airdroid.CenterManage.onServerForbidden();else{t.uploadxhrs=_.without(t.uploadxhrs,o);var r=(new Date).getTime(),a=r-n;"."!=o.upload.file.name&&t.opts.uploadFinished(o.upload.file.index,o.upload.file,o.responseText,a),0==t.files.length&&0==t.uploadxhrs.length&&t.afterAll(),t.upload()}},i.onerror=function(){t.clearResendTimeId(i),t.uploadError(null,e)},t.opts.params&&(t.opts.params.fn=t.getFilePath(e),t.opts.params.fname=t.getFilePath(e),t.opts.params.needSize&&(t.opts.params.fsize=e.size,delete t.opts.params.needSize));var o=t.opts.url;Airdroid.Util.browser.ie10||Airdroid.Util.browser.ie11?(t.opts.params=t.opts.params||{},t.opts.params.account_sid=Airdroid.Util.getCookie("account_sid")||""):i.withCredentials=!0,o=/\?/.test(t.opts.url)?t.opts.url+"&"+$.param(t.opts.params):t.opts.url+"?"+$.param(t.opts.params),console.info("upload_url===>"+o),i.open("POST",o,!0),i.setRequestHeader("Content-Type","application/octet-stream"),"."!=e.name&&i.upload.addEventListener("progress",t.progress,!1),i.send(e),t.checkSendGetBeforeUpload()&&(i.reSendTimeId=setTimeout(function(){0==i.upload.currentProgress&&(console.debug(""),t.uploadxhrs=_.without(t.uploadxhrs,i),i.abort(),Airdroid.Util.getHttpsUpload(function(){t.uploadFile(e)}))},15e3)),t.uploadxhrs.push(i)},upload:function(){var e=this;if(!e.files)return e.opts.error(e.errors[0]),!1;var t=function(){if(!Airdroid.DeviceManage.isCurrentDeviceConnected())return e.cancelAll(function(){for(;e.files.length>0;){var t=e.files.shift();e.opts.error(e._commonLang.upload_network_error,t)}_.each(e.uploadxhrs,function(t){t.upload.file&&(t.abort(),e.clearResendTimeId(t),e.uploadxhrs=_.without(e.uploadxhrs,t),e.opts.error(e._commonLang.upload_network_error,t.upload.file))})},!0),!1;for(;e.uploadxhrs.length<e.opts.maxfiles&&e.files.length>0&&!e.isCancel;){var t=e.files.shift();try{if(!e.checkAllowUpload(t)){e.uploadError(null,t);continue}e.uploadFile(t)}catch(i){return e.opts.error(e.errors[3]),!1}}};e.checkSendGetBeforeUpload()?Airdroid.Util.getHttpsUpload(function(){t()}):t()},getUniqueId:function(e){return _.uniqueId(e)},getFilePath:function(e){var t=e.name;return this.opts.isFitDir&&(t=e.webkitRelativePath,e._webkitRelativePath&&(t=e._webkitRelativePath),(""==t||_.isUndefined(t))&&(t=e.name)),e.parentPath&&(t=e.parentPath+t),t},rename:function(e){return this.opts.rename(e)},beforeEach:function(e){return"."==e.name?!0:this.opts.beforeEach(e)},afterAll:function(){return this.opts.afterAll()},dragEnter:function(e){e.preventDefault(),this.opts.dragEnter(e)},uploadError:function(e,t){var i=this;i.opts.error(i.getErrorMsgByCode(e),t),Airdroid.DeviceManage.isCurrentDeviceConnected()&&_.each(i.uploadxhrs,function(e){e.upload.file.index==t.index&&(e.abort(),i.clearResendTimeId(e),i.uploadxhrs=_.without(i.uploadxhrs,e),i.upload())})},dragOver:function(e){e.preventDefault(),this.opts.dragOver(e)},dragLeave:function(e){this.opts.dragLeave(e),e.stopPropagation()},beforeLoad:function(){this.opts.beforeLoad()},afterLoad:function(){this.opts.afterLoad()},setDropArea:function(e){this.unbindDropArea(this.opts.dropArea),this.opts.dropArea=this.removeRedundancyDropArea(e),this.bindDropArea(this.opts.dropArea)},addDropArea:function(e){this.opts.dropArea=this.opts.dropArea.add(e),this.setDropArea(this.opts.dropArea)},isDropArea:function(e){return this.opts.dropArea.find(e).length>0},removeDropArea:function(e){this.unbindDropArea(e),this.opts.dropArea=this.opts.dropArea.not(e)},removeRedundancyDropArea:function(e){return $("body").find(e)},getDropArea:function(){return this.opts.dropArea},unbindDropArea:function(e){e&&(_.isArray(e)?_.each(this.opts.dropArea,function(e){e.unbind("drop").unbind("dragenter").unbind("dragover").unbind("dragleave")}):e.unbind("drop dragenter dragover dragleave"))},bindDropArea:function(e){if(e){var t=this;_.isArray(e)?_.each(e,function(e){e.bind("drop",t.drop).bind("dragenter",t.dragEnter).bind("dragover",t.dragOver).bind("dragleave",t.dragLeave)}):e.bind("drop",t.drop).bind("dragenter",t.dragEnter).bind("dragover",t.dragOver).bind("dragleave",t.dragLeave)}}});